/* Created by Ilya A.Zhulin*/
var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(d){var a="";var l,j,g,k,h,f,e;var b=0;while(b<d.length){l=d.charCodeAt(b++);j=d.charCodeAt(b++);g=d.charCodeAt(b++);k=l>>2;h=((l&3)<<4)|(j>>4);f=((j&15)<<2)|(g>>6);e=g&63;if(isNaN(j)){f=e=64}else{if(isNaN(g)){e=64}}a=a+this._keyStr.charAt(k)+this._keyStr.charAt(h)+this._keyStr.charAt(f)+this._keyStr.charAt(e)}return a},decode:function(d){var a="";var l,j,g;var k,h,f,e;var b=0;d=d.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(b<d.length){k=this._keyStr.indexOf(d.charAt(b++));h=this._keyStr.indexOf(d.charAt(b++));f=this._keyStr.indexOf(d.charAt(b++));e=this._keyStr.indexOf(d.charAt(b++));l=(k<<2)|(h>>4);j=((h&15)<<4)|(f>>2);g=((f&3)<<6)|e;a=a+String.fromCharCode(l);if(f!=64){a=a+String.fromCharCode(j)}if(e!=64){a=a+String.fromCharCode(g)}}return a}};function sb_width(){var b=[];var a="";$this=jQuery("select#jform_params_sb1_width");b={12:6,18:6,24:6,30:3,15:15,20:20};for(var d in b){if($this.val()%b[d]===0){a+='<option value="'+d+'">'+Math.floor(d*100/60)+"%</option>"}}jQuery("select#jform_params_sb2_width").html(a);jQuery("select#jform_params_sb2_width").trigger("liszt:updated.chosen")}function ajax_query(e,f,d){id=jQuery("#jform_params_less_compile_button").attr("data-extension-id");if(f<e.length){jQuery.ajax({url:"/administrator/index.php",type:"POST",data:"option=com_templates&view=template&id="+id+"&file="+e[f]+"&task=template.less",dataType:"html",success:function(g){var a;var b=/<div id="system-message-container">((\n|.)*)<ul class="nav nav-tabs"/i;f++;if((a=b.exec(g))!==null){if(a.index===b.lastIndex){b.lastIndex++}}c=parseInt(d)*parseInt(f);if(c>100){c=100}jQuery("#jform_params_less_compile_button").parent().parent().next(".control-group").find(".progress > div").attr("style","width:"+c+"%");if(f<e.length){jQuery(".bar").html("Processing "+Base64.decode(e[f]))}else{jQuery(".bar").html("")}jQuery("#jform_params_less_compile_button").parent().parent().next(".control-group").find("ul.unstyled").append("<li>"+Base64.decode(e[f-1])+a[0].replace('<ul class="nav nav-tabs"',"")+"</li>");ajax_query(e,f,c)}})}else{jQuery("#jform_params_less_compile_button").removeAttr("disabled");jQuery(".progress").removeClass("active")}}function LessCompile(){$files=[Base64.encode("/less/uikit.less")];$custom=jQuery("#jform_params_less_custom_file").val();if($custom.length>0){$custom_files=$custom.split(",");$custom_files.forEach(function(a){$files.push(Base64.encode("/less/custom/"+a.trim()))})}$dif=100/$files.length;$html='<div class="control-group"><div class="control-label"><label title="" class="hasTooltip" title="Processing..."></label></div><div class="controls"><div class="progress progress-success progress-striped active"><div style="width: 0%" class="bar"><span class="text-error">Processing '+Base64.decode($files[0])+'...</span></div></div><ul class="unstyled"></ul></div></div>';jQuery("#jform_params_less_compile_button").attr("disabled","disabled").parent().parent().after($html);ajax_query($files,0,$dif)}jQuery(document).ready(function(){sb_width();jQuery("select#jform_params_sb1_width").on("change",function(){sb_width()});jQuery("#jform_params_less_compile_button").on("click",function(){jQuery("#jform_params_less_compile_button").parent().parent().next(".control-group").slideUp(300);setTimeout("jQuery('#jform_params_less_compile_button').parent().parent().next('.control-group').remove()",500);setTimeout(function(){LessCompile()},600)})});